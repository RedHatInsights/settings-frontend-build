(self.webpackChunkapplications=self.webpackChunkapplications||[]).push([[195],{3158:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>Y,getAppId:()=>B});var s=a(9365),r=a.n(s),n=a(5556),i=a.n(n),o=a(1225),l=a(8040),p=a(8537),c=a(6594),m=a(6401),d=a(4376),u=a(180),E=a(6525),g=a(4924),A=a(1538);const h={applicationsStore:(0,g.Lr)({[A.T.GET_SCHEMA_FULFILLED]:(e,{payload:t})=>({...e,schema:t,loaded:!0}),[A.T.GET_SCHEMA_PENDING]:e=>({...e,loaded:!1,schema:[]}),[A.T.GET_SCHEMA_REJECTED]:e=>({...e,error:!0}),[A.T.SAVE_VALUES_FULFILLED]:e=>({...e}),[A.T.GET_CONFIG_PENDING]:e=>({...e,appsConfig:{},configLoaded:!1}),[A.T.GET_CONFIG_FULFILLED]:(e,{payload:t})=>({...e,appsConfig:t,configLoaded:!0})},{loaded:!1,configLoaded:!1,error:null})};var f=a(1830),T=a(1083),v=a(6923),y=a(5361);const L=T.A.create();L.interceptors.request.use(v.kK),L.interceptors.response.use(v.bl),L.interceptors.response.use(null,v.vg),L.interceptors.response.use(null,(e=>{const t=E.Ay.getStore();throw e.response&&403===e.response.status&&t.dispatch({type:A.W,payload:403}),e})),L.interceptors.response.use(null,v.Xy),L.interceptors.response.use(null,v.u2);const S=async()=>{const e=await L.get(`/api/chrome-service/v1/static/${insights.chrome.isBeta()?"/beta":"stable"}/${insights.chrome.isProd()?"prod":"stage"}/main.yml`);return(0,y.Hh)(e)},_=async(e,t="v1")=>L.get(`/api/${e}/${t}/settings`),b=async(e,t,a="v1")=>L.post(`/api/${e}/${a}/settings/`,{...t});var C=a(3537),I=a(9085),N=a(915),k=a(983),G=a(678),F=a(3113),D=a(2069);const V=({text:e,linkProps:t})=>{let a=0;const s=e.split(/<link>/).reduce(((e,s)=>{let n=s.split(/<\/link>/);return 2===n.length&&(n[0]=r().createElement(D.E,{key:`link-${a}`,rel:"noreferrer noopener",className:"pf-u-ml-md",component:D.Y.a,target:"_blank",...t[a]},n[0]),a++),[...e,...n]}),[]);return r().createElement(D.E,{component:D.Y.p},s)};V.propTypes={text:i().string.isRequired,linkProps:i().arrayOf(i().object).isRequired};const H=({errorTitle:e,errorDescription:t})=>r().createElement(p.A,{errorTitle:e,errorDescription:r().createElement("div",{dangerouslySetInnerHTML:{__html:t}})});H.propTypes={errorTitle:i().string,errorDescription:i().string};var M=a(9866),O=a(7502),R=a(5658),U=a(2152),$=a(8840);const w={...I.Ay,"switch-field":I.Ay[O.A.SWITCH],"textarea-field":I.Ay[O.A.TEXTAREA],"select-field":I.Ay[O.A.SELECT],"plain-text-with-links":V,"error-state":H,[O.A.DUAL_LIST_SELECT]:{component:I.Ay[O.A.DUAL_LIST_SELECT],isFilterable:!0,isSortable:!0,isSearchable:!0,resolveProps:e=>({...e.leftTitle&&{availableOptionsTitle:e.leftTitle},...e.rightTitle&&{chosenOptionsTitle:e.rightTitle}}),availableOptionsActions:[r().createElement($.A,{position:"left",key:"sort"})],chosenOptionsActions:[r().createElement($.A,{position:"right",key:"sort"})]}},P={"required-validator":U.A[R.A.REQUIRED],"pattern-validator":U.A[R.A.PATTERN],"min-length-validator":U.A[R.A.MIN_LENGTH],"url-validator":U.A[R.A.URL],"max-length-validator":U.A[R.A.MAX_LENGTH],"min-items-validator":U.A[R.A.MIN_ITEMS],"exact-length-validator":U.A[R.A.EXACT_LENGTH]},x=e=>r().createElement(C.Ay,{...e,submitLabel:"Save",canReset:!0,...e.schema.formProps}),z=({schemas:e,loaded:t,saveValues:a,...n})=>{const[i,o]=(0,s.useState)();return r().createElement(G.B,{...n,hasGutter:!0},t?e.map(((e,t)=>r().createElement(F.a,{key:`settings-form-${t}`},r().createElement(N.Z,null,r().createElement(k.b,null,r().createElement(M.A,{componentMapper:w,FormTemplate:x,schema:e,submitLabel:"Save",onSubmit:(e,t)=>(o(e),t.initialize(e),a(e)),initialValues:i,validatorMapper:P})))))):r().createElement(F.a,null,r().createElement(N.Z,null,r().createElement(k.b,null,r().createElement(l.A,{size:"lg"})))))};z.propTypes={schemas:i().arrayOf(i().shape({})),loaded:i().bool,appId:i().string,saveValues:i().func},z.defaultProps={saveValues:()=>{}},x.propTypes={schema:i().object};const q=z;var X=a(128),j=a.n(X);const B=({params:e}={})=>e&&e.id||"",W=({appsConfig:e,saveValues:t,match:a,getSchema:n,getConfig:i,configLoaded:o,loaded:g,schema:A,hasError:T})=>{const v=e&&e[B(a)]||B(a),y=v.frontend&&v.frontend.title||v.title||v,[L,S]=(0,s.useState)(void 0);return(0,s.useEffect)((()=>{(0,E.kz)(h),(0,E.kz)({notifications:f.fr}),e||i(),insights.chrome.auth.getUser().then((e=>S(e.identity.user.is_org_admin)))}),[]),(0,s.useEffect)((()=>{v&&"string"!=typeof v&&n(v?.api?.apiName||a.params.id,v.api)}),[v]),r().createElement(r().Fragment,null,r().createElement(c.A,null,r().createElement(r().Fragment,null,r().createElement(m.A,{title:L?"Applications settings":j()(y)}),L&&(o?r().createElement("p",{className:"pf-u-mt-sm"},`Settings for ${j()(y)}`):r().createElement(l.A,{size:"sm"})))),"boolean"==typeof L&&!T&&r().createElement(d.Ay,null,L?r().createElement(q,{loaded:g,schemas:A,saveValues:e=>t(v?.api?.apiName||a.params.id,e,v.api,v.title)}):r().createElement(u.A,{serviceName:j()(y)})),T&&r().createElement(p.A,null))};W.propTypes={match:i().shape({params:i().shape({id:i().string})}),appsConfig:i().shape({[i().string]:i().shape({title:i().string,frontend:i().shape({title:i().string})})}),configLoaded:i().bool,getSchema:i().func,loaded:i().bool,saveValues:i().func,getConfig:i().func,schema:i().arrayOf(i().object),hasError:i().bool};const Y=(0,o.Ng)((function({applicationsStore:e}){return{schema:e&&e.schema,loaded:e&&e.loaded,appsConfig:e&&e.appsConfig,configLoaded:e&&e.configLoaded,hasError:e&&e.error}}),(function(e){return{getConfig:()=>e({type:A.T.GET_CONFIG,payload:S()}),getSchema:(t,{versions:[a]}={versions:[]})=>e(((e,t)=>({type:A.T.GET_SCHEMA,payload:_(e,t)}))(t,a)),saveValues:(t,a,{versions:[s]}={versions:[]},r)=>e(((e,t,a,s="Red Hat Insights")=>({type:A.T.SAVE_VALUES,payload:b(e,t,a),meta:{notifications:{fulfilled:{variant:"success",title:"Application settings saved",description:`Settings for ${s} were replaced with new values.`,dismissable:!0}}}}))(t,a,s,r))}}))(W)},5823:()=>{},8750:()=>{},2275:()=>{},9205:()=>{},681:()=>{},5067:()=>{},3502:()=>{},1858:()=>{},3619:()=>{},4895:()=>{},7302:()=>{},3701:()=>{},1036:()=>{},6078:()=>{},8497:()=>{},5937:()=>{},5637:()=>{},3409:()=>{},6073:()=>{},7879:()=>{},7034:()=>{},43:()=>{},8195:()=>{},1289:()=>{},2580:()=>{},6752:()=>{},5586:()=>{}}]);