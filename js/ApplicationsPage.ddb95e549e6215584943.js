"use strict";(self.webpackChunksettings_frontend=self.webpackChunksettings_frontend||[]).push([[744],{29435:(e,t,n)=>{n.r(t),n.d(t,{default:()=>fe,getAppId:()=>ue});var r,a=n(4942),o=n(29439),i=n(92950),s=n.n(i),c=n(45697),l=n.n(c),u=n(45237),p=n(56455),f=n(43846),d=n(48716),m=n(39173),v=n(86350),g=n(27839),h=n(72685),E=n(18546),b=n(58061);function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const y={applicationsStore:(0,E.Gg)((r={},(0,a.Z)(r,b.a.GET_SCHEMA_FULFILLED,(function(e,t){var n=t.payload;return Z(Z({},e),{},{schema:n,loaded:!0})})),(0,a.Z)(r,b.a.GET_SCHEMA_PENDING,(function(e){return Z(Z({},e),{},{loaded:!1,schema:[]})})),(0,a.Z)(r,b.a.GET_SCHEMA_REJECTED,(function(e){return Z(Z({},e),{},{error:!0})})),(0,a.Z)(r,b.a.SAVE_VALUES_FULFILLED,(function(e){return Z({},e)})),(0,a.Z)(r,b.a.GET_CONFIG_PENDING,(function(e){return Z(Z({},e),{},{appsConfig:{},configLoaded:!1})})),(0,a.Z)(r,b.a.GET_CONFIG_FULFILLED,(function(e,t){var n=t.payload;return Z(Z({},e),{},{appsConfig:n,configLoaded:!0})})),r),{loaded:!1,configLoaded:!1,error:null})};var P=n(83215),j=n(15861),S=n(87757),w=n.n(S),T=n(9669),L=n.n(T),_=n(77460),C=n(47180);function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var A=L().create();A.interceptors.request.use(_.w5),A.interceptors.response.use(_.xH),A.interceptors.response.use(null,_.Di),A.interceptors.response.use(null,(function(e){var t=h.ZP.getStore();throw e.response&&403===e.response.status&&t.dispatch({type:b.j,payload:403}),e})),A.interceptors.response.use(null,_.ub),A.interceptors.response.use(null,_.ud);var I=function(){var e=(0,j.Z)(w().mark((function e(){var t;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.get("".concat(insights.chrome.isBeta()?"/beta":"","/config/main.yml"));case 2:return t=e.sent,e.abrupt("return",(0,C.zD)(t));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),N=function(){var e=(0,j.Z)(w().mark((function e(t){var n,r=arguments;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:"v1",e.abrupt("return",A.get("/api/".concat(t,"/").concat(n,"/settings")));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),G=function(){var e=(0,j.Z)(w().mark((function e(t,n){var r,a=arguments;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>2&&void 0!==a[2]?a[2]:"v1",e.abrupt("return",A.post("/api/".concat(t,"/").concat(r,"/settings/"),k({},n)));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),x=function(e,t){return{type:b.a.GET_SCHEMA,payload:N(e,t)}},F=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Red Hat Insights";return{type:b.a.SAVE_VALUES,payload:G(e,t,n),meta:{notifications:{fulfilled:{variant:"success",title:"Application settings saved",description:"Settings for ".concat(r," were replaced with new values."),dismissable:!0}}}}},V=n(45987),H=n(87462),M=n(67850),R=n(11645),U=n(81159),q=n(34023),z=n(2095),X=n(85962),B=n(93433),J=n(63540),K=function(e){var t=e.text,n=e.linkProps,r=0,a=t.split(/<link>/).reduce((function(e,t){var a=t.split(/<\/link>/);return 2===a.length&&(a[0]=s().createElement(J.xv,(0,H.Z)({key:"link-".concat(r),rel:"noreferrer noopener",className:"pf-u-ml-md",component:J.qO.a,target:"_blank"},n[r]),a[0]),r++),[].concat((0,B.Z)(e),(0,B.Z)(a))}),[]);return s().createElement(J.xv,{component:J.qO.p},a)};K.propTypes={text:l().string.isRequired,linkProps:l().arrayOf(l().object).isRequired};var Q=n(93344),W=n(96354),Y=n(64124),$=n(4694),ee=n(94517);function te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?te(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):te(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var re=ne(ne({},R.ZP),{},(0,a.Z)({"switch-field":R.ZP[W.Z.SWITCH],"textarea-field":R.ZP[W.Z.TEXTAREA],"select-field":R.ZP[W.Z.SELECT],"plain-text-with-links":K},W.Z.DUAL_LIST_SELECT,{component:R.ZP[W.Z.DUAL_LIST_SELECT],isFilterable:!0,isSortable:!0,isSearchable:!0,resolveProps:function(e){return ne(ne({},e.leftTitle&&{availableOptionsTitle:e.leftTitle}),e.rightTitle&&{chosenOptionsTitle:e.rightTitle})},availableOptionsActions:[s().createElement(ee.Z,{position:"left",key:"sort"})],chosenOptionsActions:[s().createElement(ee.Z,{position:"right",key:"sort"})]})),ae={"required-validator":$.Z[Y.Z.REQUIRED],"pattern-validator":$.Z[Y.Z.PATTERN],"min-length-validator":$.Z[Y.Z.MIN_LENGTH],"url-validator":$.Z[Y.Z.URL],"max-length-validator":$.Z[Y.Z.MAX_LENGTH],"min-items-validator":$.Z[Y.Z.MIN_ITEMS],"exact-length-validator":$.Z[Y.Z.EXACT_LENGTH]},oe=function(e){return s().createElement(M.ZP,(0,H.Z)({},e,{submitLabel:"Save",canReset:!0}))},ie=function(e){var t=e.schemas,n=e.loaded,r=e.saveValues,a=(0,V.Z)(e,["schemas","loaded","saveValues"]),c=(0,i.useState)(),l=(0,o.Z)(c,2),u=l[0],f=l[1];return s().createElement(U.K,(0,H.Z)({},a,{hasGutter:!0}),n?t.map((function(e,t){return s().createElement(q.v,{key:"settings-form-".concat(t)},s().createElement(z.Zb,null,s().createElement(X.e,null,s().createElement(Q.Z,{componentMapper:re,FormTemplate:oe,schema:e,submitLabel:"Save",onSubmit:function(e,t){return f(e),t.initialize(e),r(e)},initialValues:u,validatorMapper:ae}))))})):s().createElement(q.v,null,s().createElement(z.Zb,null,s().createElement(X.e,null,s().createElement(p.Z,{size:"lg"})))))};ie.propTypes={schemas:l().arrayOf(l().shape({})),loaded:l().bool,appId:l().string,saveValues:l().func},ie.defaultProps={saveValues:function(){}};const se=ie;var ce=n(18029),le=n.n(ce),ue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.params;return t&&t.id||""},pe=function(e){var t=e.appsConfig,n=e.saveValues,r=e.match,a=e.getSchema,c=e.getConfig,l=e.configLoaded,u=e.loaded,E=e.schema,b=e.hasError,O=t&&t[ue(r)]||ue(r),Z=O.frontend&&O.frontend.title||O.title||O,j=(0,i.useState)(void 0),S=(0,o.Z)(j,2),w=S[0],T=S[1];return(0,i.useEffect)((function(){(0,h.z2)(y),(0,h.z2)({notifications:P.ee}),t||c(),insights.chrome.auth.getUser().then((function(e){return T(e.identity.user.is_org_admin)}))}),[]),(0,i.useEffect)((function(){var e;O&&"string"!=typeof O&&a((null==O||null===(e=O.api)||void 0===e?void 0:e.apiName)||r.params.id,O.api)}),[O]),s().createElement(s().Fragment,null,s().createElement(d.Z,null,s().createElement(s().Fragment,null,s().createElement(m.Z,{title:w?"Applications settings":le()(Z)}),w&&(l?s().createElement("p",{className:"pf-u-mt-sm"},"Settings for ".concat(le()(Z))):s().createElement(p.Z,{size:"sm"})))),"boolean"==typeof w&&!b&&s().createElement(v.Z,null,w?s().createElement(se,{loaded:u,schemas:E,saveValues:function(e){var t;return n((null==O||null===(t=O.api)||void 0===t?void 0:t.apiName)||r.params.id,e,O.api,O.title)}}):s().createElement(g.Z,{serviceName:le()(Z)})),b&&s().createElement(f.Z,null))};pe.propTypes={match:l().shape({params:l().shape({id:l().string})}),appsConfig:l().shape((0,a.Z)({},l().string,l().shape({title:l().string,frontend:l().shape({title:l().string})}))),configLoaded:l().bool,getSchema:l().func,loaded:l().bool,saveValues:l().func,getConfig:l().func,schema:l().arrayOf(l().object),hasError:l().bool};const fe=(0,u.connect)((function(e){var t=e.applicationsStore;return{schema:t&&t.schema,loaded:t&&t.loaded,appsConfig:t&&t.appsConfig,configLoaded:t&&t.configLoaded,hasError:t&&t.error}}),(function(e){return{getConfig:function(){return e({type:b.a.GET_CONFIG,payload:I()})},getSchema:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{versions:[]},r=(0,o.Z)(n.versions,1),a=r[0];return e(x(t,a))},saveValues:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{versions:[]},a=(0,o.Z)(r.versions,1),i=a[0],s=arguments.length>3?arguments[3]:void 0;return e(F(t,n,i,s))}}}))(pe)}}]);
//# sourceMappingURL=../sourcemaps/ApplicationsPage.c589447cc136c676288865936fd843e6.js.map